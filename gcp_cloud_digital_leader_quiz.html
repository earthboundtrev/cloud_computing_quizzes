<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GCP Cloud Digital Leader Practice Quiz</title>
  <style>
    :root {
      --bg: #0f1419;
      --surface: #1a2332;
      --accent: #4285f4;
      --accent-dim: #1a73e8;
      --text: #e2e8f0;
      --text-muted: #94a3b8;
      --correct: #22c55e;
      --wrong: #ef4444;
      --font: 'JetBrains Mono', 'Fira Code', 'Consolas', monospace;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: var(--font);
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      padding: 2rem;
      line-height: 1.6;
    }
    .container { max-width: 720px; margin: 0 auto; }
    h1 {
      font-size: 1.5rem;
      color: var(--accent);
      margin-bottom: 0.5rem;
    }
    .subtitle { color: var(--text-muted); font-size: 0.9rem; margin-bottom: 2rem; }
    .stats {
      display: flex;
      gap: 1.5rem;
      margin-bottom: 1.5rem;
      font-size: 0.85rem;
      color: var(--text-muted);
    }
    .stats span { color: var(--accent); font-weight: 600; }
    .question-card {
      background: var(--surface);
      border-radius: 8px;
      padding: 1.5rem;
      margin-bottom: 1rem;
      border-left: 3px solid var(--accent);
    }
    .question-text {
      font-size: 1.05rem;
      margin-bottom: 1rem;
      font-weight: 500;
    }
    .options { display: flex; flex-direction: column; gap: 0.5rem; }
    .option {
      padding: 0.75rem 1rem;
      background: var(--bg);
      border: 2px solid transparent;
      border-radius: 6px;
      cursor: pointer;
      transition: border-color 0.15s, background 0.15s;
    }
    .option:hover:not(.disabled) {
      border-color: var(--accent-dim);
      background: #151d2b;
    }
    .option.selected { border-color: var(--accent); background: #151d2b; }
    .option.correct { border-color: var(--correct); background: rgba(34,197,94,0.1); }
    .option.wrong { border-color: var(--wrong); background: rgba(239,68,68,0.1); }
    .option.disabled { cursor: not-allowed; opacity: 0.7; }
    .feedback {
      margin-top: 1rem;
      padding: 1rem;
      border-radius: 6px;
      font-size: 0.9rem;
    }
    .feedback.correct-msg { background: rgba(34,197,94,0.15); border-left: 4px solid var(--correct); }
    .feedback.wrong-msg { background: rgba(239,68,68,0.15); border-left: 4px solid var(--wrong); }
    .feedback .explanation { margin-top: 0.5rem; color: var(--text-muted); }
    .nav-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 1.5rem;
    }
    button {
      padding: 0.6rem 1.2rem;
      background: var(--accent);
      color: #fff;
      border: none;
      border-radius: 6px;
      font-family: inherit;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.15s;
    }
    button:hover { background: var(--accent-dim); }
    button.secondary {
      background: transparent;
      color: var(--accent);
      border: 2px solid var(--accent);
    }
    button.secondary:hover { background: rgba(66,133,244,0.1); }
    .results {
      text-align: center;
      padding: 2rem;
    }
    .results h2 { color: var(--accent); margin-bottom: 1rem; }
    .score { font-size: 2rem; font-weight: 700; margin-bottom: 1rem; }
    .results-actions { display: flex; gap: 0.75rem; justify-content: center; flex-wrap: wrap; margin-top: 1rem; }
    .results-actions button.secondary { margin: 0; }
    .copy-toast { font-size: 0.85rem; color: var(--correct); margin-top: 0.5rem; }
    .score.pass { color: var(--correct); }
    .score.fail { color: var(--wrong); }
    .start-screen { text-align: center; padding: 3rem 0; }
    .start-screen p { margin-bottom: 1.5rem; color: var(--text-muted); }
    .mode-selector { display: flex; flex-direction: column; gap: 0.75rem; margin: 1.5rem 0; max-width: 360px; margin-left: auto; margin-right: auto; }
    .mode-btn {
      padding: 1rem 1.5rem;
      text-align: left;
      background: var(--surface);
      border: 2px solid transparent;
      border-radius: 8px;
      color: var(--text);
      font-family: inherit;
      cursor: pointer;
      transition: border-color 0.15s, background 0.15s;
    }
    .mode-btn:hover { border-color: var(--accent-dim); background: #151d2b; }
    .mode-btn.selected { border-color: var(--accent); background: rgba(66,133,244,0.1); }
    .mode-btn .label { font-weight: 600; display: block; }
    .mode-btn .desc { font-size: 0.85rem; color: var(--text-muted); margin-top: 0.25rem; }
    .profile-hint { font-size: 0.85rem; color: var(--text-muted); margin-top: 0.75rem; }
    .import-area { margin-top: 1.5rem; padding-top: 1rem; border-top: 1px solid var(--surface); text-align: left; }
    .import-area label { display: block; font-size: 0.9rem; margin-bottom: 0.5rem; color: var(--text-muted); }
    .import-area textarea { width: 100%; min-height: 80px; padding: 0.5rem; background: var(--surface); border: 1px solid var(--accent-dim); border-radius: 6px; color: var(--text); font-family: inherit; font-size: 0.85rem; resize: vertical; }
    .import-toast { font-size: 0.85rem; margin-top: 0.5rem; }
    .import-toast.success { color: var(--correct); }
    .import-toast.err { color: var(--wrong); }
    .hidden { display: none !important; }
    .site-nav {
      font-family: var(--font);
      background: var(--surface);
      border-bottom: 1px solid rgba(148,163,184,0.2);
      padding: 0.75rem 1.5rem;
      margin: -2rem -2rem 2rem -2rem;
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 1rem;
    }
    .nav-brand { font-weight: 700; color: var(--text); text-decoration: none; margin-right: 0.5rem; }
    .nav-brand:hover { color: var(--accent); }
    .nav-links { display: flex; flex-wrap: wrap; gap: 0.5rem 1rem; align-items: center; }
    .nav-links a { color: var(--text-muted); text-decoration: none; font-size: 0.9rem; }
    .nav-links a:hover { color: var(--accent); }
    .back-home { display: inline-block; margin-bottom: 1rem; color: var(--text-muted); text-decoration: none; font-size: 0.9rem; }
    .back-home:hover { color: var(--accent); }
  </style>
</head>
<body>
  <header class="site-nav">
    <a href="index.html" class="nav-brand">Study Sessions</a>
    <nav class="nav-links">
      <a href="oci_foundations_quiz.html">OCI</a>
      <a href="gcp_cloud_digital_leader_quiz.html">GCP</a>
      <a href="az900_azure_fundamentals_quiz.html">Azure</a>
      <a href="aws_mlea_quiz.html">AWS MLA</a>
      <a href="aws_data_engineering_quiz.html">AWS DEA</a>
      <a href="cissp_quiz.html">CISSP</a>
      <a href="rhcsa9_quiz.html">RHCSA 9</a>
      <a href="rhce_quiz.html">RHCE</a>
    </nav>
  </header>
  <div class="container">
    <h1>GCP Cloud Digital Leader Practice Quiz</h1>
    <p class="subtitle">Based on gcp_cloud_digital_leader_guide.md</p>

    <div id="start-screen" class="start-screen">
      <a href="index.html" class="back-home">← Back to home</a>
      <p>40 questions per session, drawn from a pool of 165+. Randomized each run. Choose your mode:</p>
      <p id="focus-hint" class="profile-hint hidden"></p>
      <div class="mode-selector">
        <button type="button" class="mode-btn" data-mode="comparison" onclick="selectMode('comparison')">
          <span class="label">Comparison (GCP ↔ AWS)</span>
          <span class="desc">Map GCP services to AWS equivalents. Leverage your SAA/CCP knowledge.</span>
        </button>
        <button type="button" class="mode-btn" data-mode="exam" onclick="selectMode('exam')">
          <span class="label">Exam (Scenario-based)</span>
          <span class="desc">Business use cases, product selection, Cloud Digital Leader domains.</span>
        </button>
        <button type="button" class="mode-btn selected" data-mode="mixed" onclick="selectMode('mixed')">
          <span class="label">Mixed</span>
          <span class="desc">Both comparison and exam-style. Simulates full exam.</span>
        </button>
      </div>
      <button id="start-btn" onclick="startQuiz()">Start Quiz</button>
      <div class="import-area">
        <label for="import-results">Import past results (paste .md or choose file) to focus on weak topics:</label>
        <textarea id="import-results" placeholder="Paste quiz results markdown here..."></textarea>
        <button type="button" class="secondary" style="margin-top: 0.5rem;" onclick="importResults()">Import results</button>
        <input type="file" id="import-file" accept=".md,text/markdown" style="display: none;" onchange="onImportFile(event)">
        <button type="button" class="secondary" style="margin-top: 0.5rem; margin-left: 0.5rem;" onclick="document.getElementById('import-file').click()">Choose file</button>
        <p id="import-toast" class="import-toast hidden"></p>
      </div>
    </div>

    <div id="quiz-area" class="hidden">
      <div class="stats">
        <span>Question <span id="q-num">1</span> of <span id="q-total">40</span></span>
        <span>Correct: <span id="score-display">0</span></span>
      </div>
      <div class="question-card">
        <div class="question-text" id="question-text"></div>
        <div class="options" id="options"></div>
        <div id="feedback" class="feedback hidden"></div>
      </div>
      <div class="nav-row">
        <button id="prev-btn" class="secondary" onclick="prevQuestion()">← Previous</button>
        <button id="next-btn" onclick="nextQuestion()">Next →</button>
      </div>
    </div>

    <div id="results-screen" class="results hidden">
      <h2>Quiz Complete</h2>
      <div class="score" id="final-score"></div>
      <p id="result-msg" style="margin-bottom: 1.5rem; color: var(--text-muted);"></p>
      <div class="results-actions">
        <button onclick="startQuiz()">Try Again</button>
        <a href="index.html" class="btn-link">Back to home</a>
        <button class="secondary" onclick="downloadResults()">Download Results</button>
        <button class="secondary" onclick="copyResultsToClipboard()">Copy to Clipboard</button>
      </div>
      <p id="copy-toast" class="copy-toast hidden">Copied! Paste into Cursor chat for AI refactoring.</p>
    </div>
  </div>

  <script>
    const QUIZ_ID = 'gcp';
    const PROFILE_KEY = 'study_sessions_profile_' + QUIZ_ID;

    const questionBank = [
      // === COMPARISON (GCP ↔ AWS) ===
      { mode: "comparison", topic: "Compute",
        q: "What is the GCP equivalent of AWS EC2?",
        options: ["Cloud Run", "Compute Engine", "App Engine", "GKE"],
        correct: 1,
        explain: "Compute Engine = EC2. VMs on Google's infrastructure; rehost / lift-and-shift."
      },
      { mode: "comparison", topic: "Compute",
        q: "What is the GCP equivalent of AWS Lambda?",
        options: ["Cloud Run", "Compute Engine", "Cloud Functions", "App Engine"],
        correct: 2,
        explain: "Cloud Functions = Lambda. Event-driven, serverless functions."
      },
      { mode: "comparison", topic: "Storage",
        q: "What is the GCP equivalent of Amazon S3?",
        options: ["Cloud SQL", "BigQuery", "Cloud Storage", "Firestore"],
        correct: 2,
        explain: "Cloud Storage = S3. Object storage with classes: Standard, Nearline, Coldline, Archive."
      },
      { mode: "comparison", topic: "Database",
        q: "What is the GCP equivalent of Amazon Redshift?",
        options: ["Cloud SQL", "BigQuery", "Cloud Spanner", "Firestore"],
        correct: 1,
        explain: "BigQuery = serverless data warehouse / analytics; like Redshift but serverless."
      },
      { mode: "comparison", topic: "Database",
        q: "What is the GCP equivalent of Amazon RDS?",
        options: ["BigQuery", "Cloud Spanner", "Cloud SQL", "Bigtable"],
        correct: 2,
        explain: "Cloud SQL = RDS. Managed MySQL, PostgreSQL, SQL Server."
      },
      { mode: "comparison", topic: "Database",
        q: "Which GCP service is most like AWS DynamoDB?",
        options: ["Cloud SQL", "BigQuery", "Firestore or Cloud Bigtable", "Cloud Storage"],
        correct: 2,
        explain: "Firestore (document) and Bigtable (wide-column) = NoSQL; DynamoDB-like."
      },
      { mode: "comparison", topic: "Data",
        q: "Which GCP services are used for streaming data like AWS Kinesis?",
        options: ["BigQuery only", "Pub/Sub and Dataflow", "Cloud Storage only", "Looker"],
        correct: 1,
        explain: "Pub/Sub = messaging; Dataflow = stream/batch processing. Like Kinesis + processing."
      },
      { mode: "comparison", topic: "Security",
        q: "What is the GCP equivalent of AWS WAF or DDoS protection?",
        options: ["Cloud IAM", "Cloud Armor", "VPC", "Secret Manager"],
        correct: 1,
        explain: "Cloud Armor = WAF + DDoS protection at the edge."
      },
      { mode: "comparison", topic: "Infrastructure",
        q: "What is the GCP equivalent of AWS Elastic Beanstalk?",
        options: ["Compute Engine", "Cloud Run", "App Engine", "GKE"],
        correct: 2,
        explain: "App Engine = PaaS; deploy code without managing servers. Like Elastic Beanstalk."
      },
      { mode: "comparison", topic: "Infrastructure",
        q: "Which GCP service is used for managed Kubernetes?",
        options: ["Cloud Run", "App Engine", "GKE (Google Kubernetes Engine)", "Compute Engine"],
        correct: 2,
        explain: "GKE = managed Kubernetes. Like EKS."
      },
      { mode: "comparison", topic: "Hybrid",
        q: "Which GCP product provides a single control plane for hybrid and multicloud?",
        options: ["Cloud Run", "Anthos", "Apigee", "Compute Engine"],
        correct: 1,
        explain: "Anthos = manage workloads across on-prem, GCP, and other clouds. No direct AWS single equivalent."
      },
      { mode: "comparison", topic: "AI",
        q: "GCP pre-trained APIs (Vision, Natural Language, etc.) are most similar to which AWS services?",
        options: ["EC2", "Rekognition, Comprehend, Translate, etc.", "Redshift", "Lambda"],
        correct: 1,
        explain: "Pre-trained APIs = ready-made AI (vision, NL, translation, speech). Like Rekognition, Comprehend, etc."
      },
      // === DIGITAL TRANSFORMATION ===
      { mode: "exam", topic: "Digital Transformation",
        q: "In the cloud shared responsibility model, who is typically responsible for securing customer data and IAM policies?",
        options: ["Google only", "Customer only", "Third-party auditor", "Shared—customer secures data, apps, IAM; Google secures infrastructure"],
        correct: 3,
        explain: "Customer secures: data, identity, access, OS (IaaS), apps (PaaS). Google secures: physical, network, hypervisor."
      },
      { mode: "exam", topic: "Digital Transformation",
        q: "A company runs some workloads on-premises and some in Google Cloud. What deployment model is this?",
        options: ["Public cloud only", "Private cloud only", "Hybrid cloud", "Multicloud"],
        correct: 2,
        explain: "Hybrid = mix of on-prem and public cloud. Multicloud = multiple public clouds (e.g., GCP + AWS)."
      },
      { mode: "exam", topic: "Digital Transformation",
        q: "Which computing model requires the customer to manage the OS and applications but not the physical hardware?",
        options: ["SaaS", "PaaS", "IaaS", "FaaS"],
        correct: 2,
        explain: "IaaS (e.g., Compute Engine): you manage OS, apps, data; provider manages hardware, network, hypervisor."
      },
      { mode: "exam", topic: "Digital Transformation",
        q: "Which Google Cloud differentiator emphasizes AI/ML capabilities and open source?",
        options: ["Intelligence and freedom", "Only cost", "Only compliance", "None of these"],
        correct: 0,
        explain: "GCP differentiators: Intelligence (AI/ML), freedom (open source, multicloud), collaboration, trust, sustainability."
      },
      // === DATA TRANSFORMATION ===
      { mode: "exam", topic: "Data",
        q: "For data accessed about once a month (e.g., backups), which Cloud Storage class is most cost-effective?",
        options: ["Standard", "Nearline", "Coldline", "Archive"],
        correct: 1,
        explain: "Nearline = ~1×/month; 30-day minimum; retrieval fees. Coldline = quarterly; Archive = yearly."
      },
      { mode: "exam", topic: "Data",
        q: "A team needs a serverless data warehouse for analytics and SQL on large datasets. Which service?",
        options: ["Cloud SQL", "Cloud Spanner", "BigQuery", "Firestore"],
        correct: 2,
        explain: "BigQuery = serverless data warehouse and analytics engine; SQL at scale."
      },
      { mode: "exam", topic: "Data",
        q: "Which Cloud Storage class has a 365-day minimum storage duration and the lowest storage cost?",
        options: ["Standard", "Nearline", "Coldline", "Archive"],
        correct: 3,
        explain: "Archive = ~1×/year access; 365-day minimum; lowest cost; retrieval fees apply."
      },
      { mode: "exam", topic: "Data",
        q: "A business wants self-serve BI, dashboards, and reports integrated with their data warehouse. Which product?",
        options: ["BigQuery only", "Looker", "Cloud Storage", "Pub/Sub"],
        correct: 1,
        explain: "Looker = business intelligence; dashboards, reports; integrates with BigQuery."
      },
      { mode: "exam", topic: "Data",
        q: "For real-time streaming analytics and event pipelines, which GCP products are commonly used together?",
        options: ["Cloud SQL and BigQuery", "Pub/Sub and Dataflow", "Cloud Storage and Looker", "Compute Engine only"],
        correct: 1,
        explain: "Pub/Sub = messaging/events; Dataflow = stream and batch processing. Together for real-time pipelines."
      },
      { mode: "exam", topic: "Data",
        q: "Which GCP database is a good fit for a mobile app backend with document-style, flexible schema data?",
        options: ["Cloud SQL", "BigQuery", "Firestore", "Cloud Storage"],
        correct: 2,
        explain: "Firestore = document NoSQL; flexible schema; good for mobile and web app backends."
      },
      { mode: "exam", topic: "Data",
        q: "Which GCP database is a managed relational service supporting MySQL, PostgreSQL, and SQL Server?",
        options: ["BigQuery", "Cloud Spanner", "Cloud SQL", "Bigtable"],
        correct: 2,
        explain: "Cloud SQL = managed relational (MySQL, PostgreSQL, SQL Server). Like RDS."
      },
      // === AI ===
      { mode: "exam", topic: "AI",
        q: "A company wants to transcribe audio to text with no custom model training. Which GCP product?",
        options: ["Vertex AI", "Speech-to-Text API", "BigQuery ML", "AutoML"],
        correct: 1,
        explain: "Speech-to-Text API = pre-trained; transcribe audio to text. No training needed."
      },
      { mode: "exam", topic: "AI",
        q: "Which approach is fastest to implement when you need image labeling with no custom training?",
        options: ["Build custom model with Vertex AI", "Use Vision API", "BigQuery ML only", "TensorFlow from scratch"],
        correct: 1,
        explain: "Vision API = pre-trained image analysis (labels, faces, text). Fastest; no training."
      },
      { mode: "exam", topic: "AI",
        q: "Where can you build and run ML models using standard SQL inside a data warehouse?",
        options: ["Only with Vertex AI", "BigQuery ML", "Only pre-trained APIs", "Cloud Functions"],
        correct: 1,
        explain: "BigQuery ML = create and run ML models in BigQuery using SQL. For analytics teams."
      },
      { mode: "exam", topic: "AI",
        q: "For training custom ML models with your own data and full control, which GCP platform is typically used?",
        options: ["Only pre-trained APIs", "Vertex AI", "Cloud Storage only", "Looker"],
        correct: 1,
        explain: "Vertex AI = full ML platform; custom models, your data; differentiation. AutoML = less code, still custom."
      },
      { mode: "exam", topic: "AI",
        q: "Which Google hardware is optimized for TensorFlow and ML performance?",
        options: ["Only standard VMs", "Cloud TPU", "Cloud Storage", "BigQuery"],
        correct: 1,
        explain: "Cloud TPU = Google's proprietary ML-optimized hardware; works with TensorFlow."
      },
      // === INFRASTRUCTURE / MODERNIZE ===
      { mode: "exam", topic: "Infrastructure",
        q: "A company wants to migrate existing VMs to the cloud with minimal changes. Which migration approach and GCP product?",
        options: ["Refactor to microservices on Cloud Run", "Rehost (lift and shift) with Compute Engine", "Retire the workload", "Use only BigQuery"],
        correct: 1,
        explain: "Rehost = lift and shift; minimal changes. Compute Engine = VMs on GCP."
      },
      { mode: "exam", topic: "Infrastructure",
        q: "Which GCP product is best for running serverless containers that scale to zero?",
        options: ["Compute Engine", "GKE only", "Cloud Run", "Cloud Storage"],
        correct: 2,
        explain: "Cloud Run = serverless containers; scale to zero; no cluster to manage."
      },
      { mode: "exam", topic: "Infrastructure",
        q: "A business wants to expose and monetize APIs with rate limiting and developer portal. Which product?",
        options: ["Cloud Functions", "Apigee", "Cloud Armor", "VPC"],
        correct: 1,
        explain: "Apigee = API management; expose, secure, monetize APIs; rate limits, developer portal."
      },
      { mode: "exam", topic: "Infrastructure",
        q: "Which term means moving an application to the cloud with minimal changes?",
        options: ["Refactor", "Replatform", "Rehost (lift and shift)", "Retire"],
        correct: 2,
        explain: "Rehost = lift and shift; move as-is. Replatform = some optimization; refactor = redesign."
      },
      { mode: "exam", topic: "Infrastructure",
        q: "For a fully managed PaaS where developers deploy code without managing servers, which GCP product?",
        options: ["Compute Engine", "GKE", "App Engine", "Cloud Storage"],
        correct: 2,
        explain: "App Engine = PaaS; deploy code; Google manages runtime, scaling, infrastructure."
      },
      // === SECURITY ===
      { mode: "exam", topic: "Security",
        q: "Which GCP product helps protect applications from DDoS and application-layer attacks (e.g., WAF)?",
        options: ["Cloud IAM only", "Cloud Armor", "VPC only", "Secret Manager"],
        correct: 1,
        explain: "Cloud Armor = DDoS protection and WAF at the edge."
      },
      { mode: "exam", topic: "Security",
        q: "What does two-step verification (2SV) provide?",
        options: ["Only encryption", "A second factor for sign-in (e.g., phone or key)", "API rate limiting", "Data residency"],
        correct: 1,
        explain: "2SV = something you know + something you have; strengthens authentication."
      },
      { mode: "exam", topic: "Security",
        q: "A company must keep data stored only in the EU for compliance. What GCP capability addresses this?",
        options: ["Only encryption", "Data residency / region selection", "Cloud Armor", "Apigee"],
        correct: 1,
        explain: "Data residency = where data is stored; GCP lets you choose regions to meet sovereignty/compliance."
      },
      { mode: "exam", topic: "Security",
        q: "Authentication in IAM is best described as:",
        options: ["What an identity is allowed to do", "Verifying identity (who you are)", "Encrypting data", "Auditing actions"],
        correct: 1,
        explain: "Authentication = verifying identity. Authorization = what you're allowed to do (permissions)."
      },
      // === OPERATIONS ===
      { mode: "exam", topic: "Operations",
        q: "A team wants to visualize and analyze cloud spend by project and service. Which GCP tool?",
        options: ["Only quotas", "Cloud Billing Reports", "Cloud Armor", "Apigee"],
        correct: 1,
        explain: "Cloud Billing Reports = visualize and analyze cost; set budgets and alerts."
      },
      { mode: "exam", topic: "Operations",
        q: "To get alerts when spending reaches 80% of a threshold, what should be configured?",
        options: ["Only quotas", "Budget and budget alerts (threshold rules)", "Cloud Armor", "IAM roles only"],
        correct: 1,
        explain: "Budgets + threshold rules (e.g., 50%, 90%, 100%) send alerts; they do not block spending."
      },
      { mode: "exam", topic: "Operations",
        q: "Which concept describes measuring reliability with metrics (SLIs) and targets (SLOs)?",
        options: ["Only DevOps", "SRE (Site Reliability Engineering)", "Only IAM", "Data residency"],
        correct: 1,
        explain: "SRE uses SLIs (metrics), SLOs (targets), and error budgets for reliability."
      },
      { mode: "exam", topic: "Operations",
        q: "Google Cloud's commitment to carbon-neutral operations and efficiency aligns with which theme?",
        options: ["Only cost", "Sustainability", "Only compliance", "API management"],
        correct: 1,
        explain: "Sustainability = efficiency, carbon-neutral operations, tools for environmental impact."
      },
      // === MORE COMPARISON ===
      { mode: "comparison", topic: "Data",
        q: "AWS Athena (SQL on S3) is most similar to which GCP capability?",
        options: ["Cloud SQL", "BigQuery (serverless SQL, including on Cloud Storage)", "Looker only", "Pub/Sub"],
        correct: 1,
        explain: "BigQuery = serverless SQL analytics; can query data in Cloud Storage and other sources."
      },
      { mode: "comparison", topic: "Security",
        q: "GCP Cloud IAM is equivalent to which AWS service?",
        options: ["S3", "IAM", "Lambda", "Redshift"],
        correct: 1,
        explain: "Cloud IAM = AWS IAM. Roles, permissions, identity for GCP resources."
      },
      { mode: "comparison", topic: "Infrastructure",
        q: "Which GCP service is equivalent to AWS Lambda for event-driven serverless functions?",
        options: ["Compute Engine", "Cloud Run", "Cloud Functions", "App Engine"],
        correct: 2,
        explain: "Cloud Functions = Lambda. Event-driven, serverless functions."
      },
      { mode: "exam", topic: "Data",
        q: "Which Cloud Storage class has no minimum storage duration and no retrieval fee?",
        options: ["Nearline", "Coldline", "Archive", "Standard"],
        correct: 3,
        explain: "Standard = hot data; no minimum, no retrieval fee. Best for frequently accessed data."
      },
      { mode: "exam", topic: "AI",
        q: "Which pre-trained API would you use to detect sentiment and entities in text?",
        options: ["Vision API", "Natural Language API", "Speech-to-Text API", "Cloud Storage"],
        correct: 1,
        explain: "Natural Language API = entity recognition, sentiment analysis, syntax, content classification."
      },
      { mode: "exam", topic: "AI",
        q: "Which pre-trained API is used to translate text between languages?",
        options: ["Vision API", "Natural Language API", "Cloud Translation API", "Text-to-Speech API"],
        correct: 2,
        explain: "Cloud Translation API = translate text between languages."
      },
      { mode: "exam", topic: "Digital Transformation",
        q: "When an organization uses both GCP and AWS for different workloads, what is this called?",
        options: ["Hybrid cloud only", "Multicloud", "Private cloud", "On-premises only"],
        correct: 1,
        explain: "Multicloud = multiple public clouds (e.g., GCP + AWS). Hybrid = on-prem + cloud."
      },
      { mode: "exam", topic: "Infrastructure",
        q: "What does Anthos provide for organizations?",
        options: ["Only API management", "Single control plane for hybrid and multicloud workloads", "Only object storage", "Only networking"],
        correct: 1,
        explain: "Anthos = manage workloads across on-prem, GCP, and other clouds with a consistent platform."
      },
      { mode: "exam", topic: "Security",
        q: "In the shared responsibility model, who is responsible for securing the physical data center?",
        options: ["Customer only", "Google (cloud provider)", "Shared equally", "Third party only"],
        correct: 1,
        explain: "Google secures: physical infrastructure, network, hypervisor. Customer secures: data, IAM, apps, OS (in IaaS)."
      },
      { mode: "exam", topic: "Data",
        q: "Which GCP database is suited to global scale, strong consistency, and relational semantics?",
        options: ["Firestore only", "Cloud SQL", "Cloud Spanner", "Bigtable only"],
        correct: 2,
        explain: "Cloud Spanner = globally distributed relational; strong consistency; horizontal scale."
      },
      { mode: "exam", topic: "Operations",
        q: "GCP resource hierarchy (Organization → Folders → Projects) is mainly used for:",
        options: ["Only networking", "Organizing resources and applying IAM/governance", "Only AI", "Only storage classes"],
        correct: 1,
        explain: "Resource hierarchy = organize resources and inherit IAM policies; governance and cost organization."
      },
      { topic: "Digital Transformation",
        q: "Which of these is a benefit of moving from on-premises to the cloud?",
        options: ["Higher capital expenditure (CapEx)", "Shift from CapEx to OpEx (pay as you go)", "Less elasticity", "Fixed capacity only"],
        correct: 1,
        explain: "Cloud shifts CapEx to OpEx; pay for what you use; scalable and elastic."
      },
      { topic: "Data",
        q: "Coldline storage is best for data accessed how often?",
        options: ["Daily", "About once a month", "About once a quarter or less", "Multiple times per day"],
        correct: 2,
        explain: "Coldline = ~1×/quarter; 90-day minimum; lower storage cost, retrieval fees."
      },
      { topic: "Infrastructure",
        q: "Which GCP product runs event-triggered code without managing servers?",
        options: ["Compute Engine", "Cloud Functions", "Cloud Storage", "BigQuery"],
        correct: 1,
        explain: "Cloud Functions = serverless, event-driven; no server management."
      },
      // More comparison for mode balance
      { mode: "comparison", topic: "Storage",
        q: "GCP Cloud Storage Coldline and Archive are most similar to which AWS storage?",
        options: ["S3 Standard", "EBS", "S3 Glacier / Glacier Deep Archive", "EFS"],
        correct: 2,
        explain: "Coldline/Archive = infrequent/archival; like S3 Glacier tiers."
      },
      { mode: "comparison", topic: "Infrastructure",
        q: "GCP Cloud Run (serverless containers) is most similar to which AWS offering?",
        options: ["EC2", "Lambda", "Fargate (serverless containers) or Lambda", "RDS"],
        correct: 2,
        explain: "Cloud Run = serverless containers; like Fargate. Also comparable to Lambda for event-driven."
      },
      { mode: "comparison", topic: "Data",
        q: "GCP Looker is most similar to which AWS service for BI and dashboards?",
        options: ["S3", "QuickSight", "Redshift", "Lambda"],
        correct: 1,
        explain: "Looker = BI, dashboards, self-serve analytics; like QuickSight."
      },
      { mode: "comparison", topic: "Database",
        q: "GCP Cloud Spanner (global relational) has no direct AWS equivalent that matches all features. It is closest to:",
        options: ["RDS", "DynamoDB", "Aurora (global scale + strong consistency)", "Redshift"],
        correct: 2,
        explain: "Cloud Spanner = globally distributed, strongly consistent relational; Aurora Global is closest."
      },
      { mode: "comparison", topic: "AI",
        q: "GCP Vertex AI is most similar to which AWS service for custom ML?",
        options: ["S3", "SageMaker", "Redshift", "Lambda"],
        correct: 1,
        explain: "Vertex AI = full ML platform, custom models; like SageMaker."
      },
      // === TRIPLED BANK: GCP Cloud Digital Leader ===
      { mode: "comparison", topic: "Compute",
        q: "GCP Preemptible VMs are most similar to which AWS offering?",
        options: ["Reserved Instances", "Spot Instances", "On-Demand only", "Savings Plans"],
        correct: 1,
        explain: "Preemptible = interruptible, low cost; like AWS Spot."
      },
      { mode: "comparison", topic: "Storage",
        q: "GCP Persistent Disk is equivalent to which AWS service?",
        options: ["S3", "EBS", "EFS", "Glacier"],
        correct: 1,
        explain: "Persistent Disk = block storage for VMs; like EBS."
      },
      { mode: "exam", topic: "Digital Transformation",
        q: "Which benefit does cloud typically provide over on-premises?",
        options: ["Higher fixed costs", "Rapid elasticity and scalability", "Less flexibility", "Longer provisioning times"],
        correct: 1,
        explain: "Cloud = rapid elasticity, scale on demand, faster provisioning."
      },
      { mode: "exam", topic: "Data",
        q: "Which Cloud Storage class has a 90-day minimum storage duration?",
        options: ["Standard", "Nearline", "Coldline", "Archive"],
        correct: 2,
        explain: "Coldline = 90-day minimum. Nearline = 30-day. Archive = 365-day."
      },
      { mode: "exam", topic: "AI",
        q: "Which pre-trained API would you use to convert text to spoken audio?",
        options: ["Speech-to-Text", "Natural Language", "Text-to-Speech API", "Vision API"],
        correct: 2,
        explain: "Text-to-Speech API = synthesize speech from text."
      },
      { mode: "exam", topic: "Infrastructure",
        q: "Which GCP product is a fully managed relational database for MySQL, PostgreSQL, or SQL Server?",
        options: ["BigQuery", "Cloud Spanner", "Cloud SQL", "Bigtable"],
        correct: 2,
        explain: "Cloud SQL = managed MySQL, PostgreSQL, SQL Server. Like RDS."
      },
      { mode: "exam", topic: "Security",
        q: "Cloud IAM allows you to grant access by:",
        options: ["Only to users", "To users, groups, and service accounts", "Only to projects", "Only to buckets"],
        correct: 1,
        explain: "IAM = assign roles to users, groups, service accounts at org/folder/project/resource."
      },
      { mode: "exam", topic: "Operations",
        q: "GCP quotas limit:",
        options: ["Only cost", "Resource usage (e.g., vCPUs, disks per project/region)", "Only storage", "Only networking"],
        correct: 1,
        explain: "Quotas = limits on resources (vCPUs, instances, API rate); request increase if needed."
      },
      { mode: "exam", topic: "Data",
        q: "Pub/Sub is used for:",
        options: ["Only storage", "Asynchronous messaging and event ingestion", "Only SQL", "Only batch"],
        correct: 1,
        explain: "Pub/Sub = publish/subscribe messaging; decouple services; event-driven; like SQS/SNS."
      },
      { mode: "exam", topic: "AI",
        q: "AutoML is best for:",
        options: ["Only pre-trained APIs", "Training custom models with minimal ML expertise", "Only BigQuery ML", "Only TPU"],
        correct: 1,
        explain: "AutoML = train custom models with your data; less code than full Vertex AI."
      },
      { mode: "exam", topic: "Infrastructure",
        q: "Which migration strategy involves changing the application architecture for the cloud?",
        options: ["Rehost", "Replatform", "Refactor (rearchitect)", "Retire"],
        correct: 2,
        explain: "Refactor = rearchitect for cloud (e.g., microservices, serverless)."
      },
      { mode: "exam", topic: "Digital Transformation",
        q: "In PaaS, who typically manages the runtime and operating system?",
        options: ["Customer only", "Cloud provider", "Third party only", "Shared 50/50"],
        correct: 1,
        explain: "PaaS: provider manages runtime, OS, infrastructure; you manage apps and data."
      },
      { mode: "exam", topic: "Data",
        q: "BigQuery charges are primarily based on:",
        options: ["Only storage", "Storage and query processing (bytes scanned)", "Only ingestion", "Only export"],
        correct: 1,
        explain: "BigQuery = pay for storage and for queries (bytes scanned); slot time for on-demand."
      },
      { mode: "exam", topic: "Security",
        q: "Secret Manager in GCP is used for:",
        options: ["Only encryption keys", "Storing and managing secrets (passwords, API keys)", "Only IAM", "Only networking"],
        correct: 1,
        explain: "Secret Manager = store, version, and access secrets; like AWS Secrets Manager."
      },
      { mode: "exam", topic: "Operations",
        q: "GCP billing is organized by:",
        options: ["Region only", "Project (and linked billing account)", "Only folder", "Only organization"],
        correct: 1,
        explain: "Billing = billing account linked to one or more projects; track cost per project."
      },
      { mode: "comparison", topic: "Networking",
        q: "GCP VPC (Virtual Private Cloud) is similar to:",
        options: ["Only Cloud DNS", "AWS VPC (isolated network)", "Only Load Balancer", "Only Cloud CDN"],
        correct: 1,
        explain: "GCP VPC = logically isolated network; subnets, firewall; like AWS VPC."
      },
      { mode: "exam", topic: "AI",
        q: "Document AI is used for:",
        options: ["Only image labeling", "Extracting data from documents (invoices, forms)", "Only translation", "Only speech"],
        correct: 1,
        explain: "Document AI = extract structured data from documents; pre-trained and custom processors."
      },
      { mode: "exam", topic: "Infrastructure",
        q: "Which GCP product allows running containers without managing the underlying cluster?",
        options: ["GKE only", "Cloud Run (serverless containers)", "Compute Engine only", "App Engine only"],
        correct: 1,
        explain: "Cloud Run = serverless containers; no cluster; scale to zero."
      },
      { mode: "exam", topic: "Data",
        q: "Dataflow is used for:",
        options: ["Only storage", "Stream and batch data processing (Apache Beam)", "Only SQL", "Only Pub/Sub"],
        correct: 1,
        explain: "Dataflow = managed Apache Beam; stream and batch processing; like Kinesis Data Analytics."
      },
      { mode: "exam", topic: "Digital Transformation",
        q: "Which term describes using technology to change how a business operates and delivers value?",
        options: ["Only cloud migration", "Digital transformation", "Only DevOps", "Only IaaS"],
        correct: 1,
        explain: "Digital transformation = using tech to change operations and value delivery."
      },
      { mode: "exam", topic: "Security",
        q: "VPC Service Controls help with:",
        options: ["Only DDoS", "Data exfiltration prevention (perimeter around GCP services)", "Only IAM", "Only encryption"],
        correct: 1,
        explain: "VPC Service Controls = perimeter; restrict which resources can be accessed from where."
      },
      { mode: "exam", topic: "Operations",
        q: "SLO (Service Level Objective) is:",
        options: ["Only a metric", "A target level of service (e.g., 99.9% uptime)", "Only for cost", "Only for security"],
        correct: 1,
        explain: "SLO = target for a service level; e.g., 99.9% availability; basis for SLAs."
      },
      { mode: "exam", topic: "Data",
        q: "Which GCP database is best for global, horizontally scalable, strongly consistent relational data?",
        options: ["Cloud SQL only", "Firestore only", "Cloud Spanner", "Bigtable only"],
        correct: 2,
        explain: "Cloud Spanner = globally distributed, strongly consistent, relational; horizontal scale."
      },
      { mode: "exam", topic: "AI",
        q: "Vertex AI Feature Store is used for:",
        options: ["Only training", "Storing and serving ML features for training and prediction", "Only inference", "Only BigQuery"],
        correct: 1,
        explain: "Feature Store = centralized store for ML features; reuse across models; avoid skew."
      },
      { mode: "exam", topic: "Infrastructure",
        q: "Which GCP offering runs on-premises and in other clouds with a consistent experience?",
        options: ["Only Compute Engine", "Anthos", "Only GKE", "Only Cloud Run"],
        correct: 1,
        explain: "Anthos = run and manage workloads on-prem, GCP, other clouds; consistent platform."
      },
      { mode: "exam", topic: "Digital Transformation",
        q: "OpEx (operational expenditure) in the cloud typically:",
        options: ["Decreases with scale", "Replaces upfront CapEx with pay-as-you-go", "Is only for storage", "Is only for compute"],
        correct: 1,
        explain: "Cloud shifts CapEx to OpEx; pay as you use."
      },
      { mode: "exam", topic: "Data",
        q: "Cloud Storage uniform bucket-level access means:",
        options: ["Only IAM applies (no ACLs)", "Only ACLs apply", "No access control", "Only for BigQuery"],
        correct: 0,
        explain: "Uniform = IAM only for access; recommended over fine-grained ACLs."
      },
      { mode: "exam", topic: "Security",
        q: "BeyondCorp Enterprise provides:",
        options: ["Only VPN", "Zero-trust access (secure access without VPN)", "Only firewall", "Only DDoS"],
        correct: 1,
        explain: "BeyondCorp = zero-trust; access based on identity and context; no traditional VPN."
      },
      { mode: "exam", topic: "Operations",
        q: "Cloud Monitoring (formerly Stackdriver) provides:",
        options: ["Only billing", "Metrics, logs, and alerts for GCP and hybrid", "Only IAM", "Only networking"],
        correct: 1,
        explain: "Cloud Monitoring = metrics, logs, uptime checks, alerting; like CloudWatch."
      },
      { mode: "comparison", topic: "Database",
        q: "GCP Firestore is most similar to which AWS service?",
        options: ["RDS", "DynamoDB (document/key-value)", "Redshift", "S3"],
        correct: 1,
        explain: "Firestore = document NoSQL; real-time; like DynamoDB + real-time."
      },
      { mode: "exam", topic: "AI",
        q: "Which pre-trained API would you use to detect objects and labels in an image?",
        options: ["Natural Language", "Vision API", "Translation", "Text-to-Speech"],
        correct: 1,
        explain: "Vision API = image analysis; labels, objects, faces, text, etc."
      },
      { mode: "exam", topic: "Infrastructure",
        q: "Committed Use Discounts (CUDs) in GCP provide:",
        options: ["No discount", "Discount for committing to 1 or 3 years of usage", "Only for storage", "Only for networking"],
        correct: 1,
        explain: "CUDs = commit to vCPU/memory for 1 or 3 years; significant discount. Like RIs."
      },
      { mode: "exam", topic: "Data",
        q: "Datastream is used for:",
        options: ["Only batch", "Replication from relational DBs (e.g., MySQL, Oracle) to GCP", "Only Pub/Sub", "Only BigQuery"],
        correct: 1,
        explain: "Datastream = CDC from relational DBs to GCP (BigQuery, etc.); like DMS."
      },
      { mode: "exam", topic: "Digital Transformation",
        q: "Which deployment model uses multiple public cloud providers?",
        options: ["Private only", "Hybrid only", "Multicloud", "On-premises only"],
        correct: 2,
        explain: "Multicloud = use multiple public clouds (e.g., GCP + AWS + Azure)."
      },
      { mode: "exam", topic: "Security",
        q: "Cloud KMS in GCP is used for:",
        options: ["Only secrets", "Managing encryption keys", "Only IAM", "Only networking"],
        correct: 1,
        explain: "Cloud KMS = create and manage encryption keys; use with Cloud Storage, BigQuery, etc."
      },
      { mode: "exam", topic: "Operations",
        q: "Error budget in SRE represents:",
        options: ["Only cost", "Allowable unreliability (e.g., to release new features)", "Only security", "Only latency"],
        correct: 1,
        explain: "Error budget = 1 - SLO; how much failure is acceptable; balance reliability and velocity."
      },
      { mode: "exam", topic: "Data",
        q: "BigQuery Omni allows:",
        options: ["Only GCP data", "Querying data in AWS and Azure (multicloud analytics)", "Only Cloud Storage", "Only Pub/Sub"],
        correct: 1,
        explain: "BigQuery Omni = run BigQuery on data in AWS/Azure; multicloud analytics."
      },
      { mode: "exam", topic: "AI",
        q: "Vertex AI Pipelines are used for:",
        options: ["Only inference", "Orchestrating ML workflows (train, evaluate, deploy)", "Only data labeling", "Only AutoML"],
        correct: 1,
        explain: "Pipelines = orchestrate ML steps; Kubeflow Pipelines; automate train-evaluate-deploy."
      },
      { mode: "exam", topic: "Infrastructure",
        q: "Which GCP product is best for hosting a static website with global CDN?",
        options: ["Only Compute Engine", "Cloud Storage + Cloud CDN", "Only BigQuery", "Only Pub/Sub"],
        correct: 1,
        explain: "Cloud Storage (static site) + Cloud CDN = cheap, fast static hosting. Like S3 + CloudFront."
      },
      { mode: "exam", topic: "Digital Transformation",
        q: "IaaS is best when the customer needs:",
        options: ["Only to use an app", "Full control over OS and applications", "Only to deploy code", "Only databases"],
        correct: 1,
        explain: "IaaS = you manage OS, apps, data; max control; e.g., Compute Engine."
      },
      { mode: "exam", topic: "Data",
        q: "Looker Studio (formerly Data Studio) provides:",
        options: ["Only ETL", "Free dashboards and reports (connect to BigQuery, etc.)", "Only storage", "Only ML"],
        correct: 1,
        explain: "Looker Studio = free BI; dashboards, reports; connect to BigQuery, Sheets, etc."
      },
      { mode: "exam", topic: "Security",
        q: "Binary Authorization helps with:",
        options: ["Only networking", "Ensuring only verified container images deploy", "Only IAM", "Only encryption"],
        correct: 1,
        explain: "Binary Authorization = attest that only approved/verified images run in GKE."
      },
      { mode: "exam", topic: "Operations",
        q: "GCP labels are used for:",
        options: ["Only networking", "Organizing and filtering resources; cost allocation", "Only compute", "Only storage"],
        correct: 1,
        explain: "Labels = key-value on resources; filter in console; use in billing reports."
      },
      { mode: "comparison", topic: "Data",
        q: "GCP Dataproc is similar to which AWS service?",
        options: ["Lambda", "EMR (managed Hadoop/Spark)", "RDS", "S3"],
        correct: 1,
        explain: "Dataproc = managed Hadoop/Spark; like EMR."
      },
      { mode: "exam", topic: "AI",
        q: "Vertex AI Model Monitoring helps with:",
        options: ["Only training", "Detecting drift and performance issues in deployed models", "Only data labeling", "Only AutoML"],
        correct: 1,
        explain: "Model monitoring = detect data/skill drift; alert when model degrades."
      },
      { mode: "exam", topic: "Infrastructure",
        q: "Which GCP service is a managed message queue for asynchronous workloads?",
        options: ["Cloud Storage", "Pub/Sub", "BigQuery", "Cloud SQL"],
        correct: 1,
        explain: "Pub/Sub = async messaging; decouple publishers and subscribers."
      },
      { mode: "exam", topic: "Data",
        q: "Transfer Service for on-premises can use:",
        options: ["Only online transfer", "Online transfer or offline (physical appliance)", "Only BigQuery", "Only Pub/Sub"],
        correct: 1,
        explain: "Transfer Service = online or offline (Transfer Appliance) for large data migration."
      },
      { mode: "exam", topic: "Digital Transformation",
        q: "Cloud-native applications are typically:",
        options: ["Only monolithic", "Designed for scalability, resilience, and API-driven operations", "Only on-prem", "Only legacy"],
        correct: 1,
        explain: "Cloud-native = designed for cloud; scalable, resilient, microservices, APIs."
      },
      { mode: "exam", topic: "Security",
        q: "Shielded VMs in GCP provide:",
        options: ["Only encryption", "Firmware and boot integrity (measured boot, vTPM)", "Only IAM", "Only firewall"],
        correct: 1,
        explain: "Shielded VMs = secure boot, vTPM, integrity monitoring; resist rootkits."
      },
      { mode: "exam", topic: "Operations",
        q: "GCP Recommender provides:",
        options: ["Only security", "Recommendations for cost, performance, security, reliability", "Only networking", "Only storage"],
        correct: 1,
        explain: "Recommender = actionable recommendations (idle resources, right-sizing, etc.)."
      },
      { mode: "exam", topic: "Data",
        q: "BigQuery Data Transfer Service can load from:",
        options: ["Only GCP", "S3, Teradata, and other sources (scheduled)", "Only Pub/Sub", "Only Cloud Storage"],
        correct: 1,
        explain: "Data Transfer Service = scheduled loads from S3, Teradata, etc., into BigQuery."
      },
      { mode: "exam", topic: "AI",
        q: "Vertex AI Training is used for:",
        options: ["Only inference", "Training custom models at scale", "Only pre-trained APIs", "Only BigQuery ML"],
        correct: 1,
        explain: "Vertex AI Training = train custom models; managed; scale with GPU/TPU."
      },
      { mode: "exam", topic: "Infrastructure",
        q: "Sustained Use Discounts in GCP apply when:",
        options: ["You use spot only", "You run VMs for a significant portion of the month", "Only for 1 year", "Only for storage"],
        correct: 1,
        explain: "Sustained use = automatic discount when you use Compute Engine for much of the month."
      },
      { mode: "exam", topic: "Digital Transformation",
        q: "Which Google Cloud theme emphasizes open source and avoiding vendor lock-in?",
        options: ["Only cost", "Freedom (open source, multicloud)", "Only compliance", "Only AI"],
        correct: 1,
        explain: "Freedom = open source, multicloud, portability; not locked in."
      },
      { mode: "exam", topic: "Data",
        q: "Cloud SQL high availability typically uses:",
        options: ["Single zone only", "Regional configuration (primary + standby in another zone)", "Only read replicas", "Only backup"],
        correct: 1,
        explain: "Cloud SQL HA = primary + standby in different zone; automatic failover."
      },
      { mode: "exam", topic: "Security",
        q: "Context-Aware Access in IAM allows:",
        options: ["Only IP allowlist", "Access based on device, location, and other attributes", "Only MFA", "Only encryption"],
        correct: 1,
        explain: "Context-Aware Access = grant access based on context (device, location, etc.)."
      },
      { mode: "exam", topic: "Operations",
        q: "GCP organization is the top of the resource hierarchy and is used for:",
        options: ["Only billing", "Central policy and governance across folders and projects", "Only networking", "Only one project"],
        correct: 1,
        explain: "Organization = root of hierarchy; apply IAM and policy across all projects/folders."
      },
      { mode: "comparison", topic: "Security",
        q: "GCP Chronicle (Security Operations) is similar to:",
        options: ["S3", "SIEM / security analytics", "Lambda", "Redshift"],
        correct: 1,
        explain: "Chronicle = security operations; SIEM; ingest and analyze security data."
      },
      { mode: "exam", topic: "AI",
        q: "Vertex AI Notebooks provide:",
        options: ["Only inference", "Managed Jupyter notebooks for ML development", "Only BigQuery", "Only Pub/Sub"],
        correct: 1,
        explain: "Vertex AI Notebooks = managed Jupyter; pre-installed ML libs; like SageMaker Notebooks."
      },
      { mode: "exam", topic: "Infrastructure",
        q: "Which GCP product is a serverless, fully managed data warehouse?",
        options: ["Cloud SQL", "Cloud Spanner", "BigQuery", "Bigtable"],
        correct: 2,
        explain: "BigQuery = serverless data warehouse; no infrastructure; SQL at scale."
      },
      { mode: "exam", topic: "Data",
        q: "Dataplex provides:",
        options: ["Only ETL", "Data governance and discovery across data lakes", "Only BigQuery", "Only Pub/Sub"],
        correct: 1,
        explain: "Dataplex = unified data governance; discover, classify, manage data lakes."
      },
      { mode: "exam", topic: "Digital Transformation",
        q: "Which Google Cloud differentiator focuses on AI and machine learning capabilities?",
        options: ["Only cost", "Intelligence", "Only compliance", "Only networking"],
        correct: 1,
        explain: "Intelligence = AI/ML; Vertex AI, pre-trained APIs, TPU."
      },
      { mode: "exam", topic: "Security",
        q: "Cloud Audit Logs in GCP record:",
        options: ["Only application logs", "Admin and data access for GCP resources", "Only networking", "Only cost"],
        correct: 1,
        explain: "Cloud Audit Logs = admin activity and data access; who did what; like CloudTrail."
      },
      { mode: "exam", topic: "Operations",
        q: "Budget alerts in GCP:",
        options: ["Block spending when exceeded", "Notify when thresholds are reached (do not block)", "Only for free tier", "Only for committed use"],
        correct: 1,
        explain: "Budget alerts = notify at 50%, 90%, 100%, etc.; they do not block spending."
      },
      { mode: "exam", topic: "Data",
        q: "Bigtable is best for:",
        options: ["Only SQL analytics", "High-throughput, low-latency key-value and wide-column workloads", "Only document", "Only batch"],
        correct: 1,
        explain: "Bigtable = wide-column, key-value; high throughput; time-series, IoT; like HBase/DynamoDB."
      },
      { mode: "exam", topic: "AI",
        q: "Vertex AI Explainable AI helps with:",
        options: ["Only training", "Understanding why a model made a prediction", "Only inference", "Only data labeling"],
        correct: 1,
        explain: "Explainable AI = interpretability; feature attributions; understand model decisions."
      },
      { mode: "exam", topic: "Infrastructure",
        q: "GKE Autopilot provides:",
        options: ["Only manual node management", "Kubernetes with nodes fully managed by Google", "Only on-prem", "Only serverless functions"],
        correct: 1,
        explain: "GKE Autopilot = GKE with no node management; Google manages nodes; pay per pod."
      },
      { mode: "exam", topic: "Digital Transformation",
        q: "In the shared responsibility model, who secures the hypervisor?",
        options: ["Customer", "Cloud provider (Google)", "Shared", "Third party only"],
        correct: 1,
        explain: "Provider secures: physical, network, hypervisor. Customer secures: data, IAM, OS (IaaS), app (PaaS)."
      },
      { mode: "exam", topic: "Data",
        q: "Cloud Storage transfer between regions:",
        options: ["Is not supported", "Can be done (e.g., gsutil or Transfer Service)", "Only within same region", "Only for BigQuery"],
        correct: 1,
        explain: "Copy/move between regions via gsutil, Transfer Service, or lifecycle rules."
      },
      { mode: "exam", topic: "Security",
        q: "Assured Workloads helps with:",
        options: ["Only cost", "Compliance (e.g., FedRAMP, HIPAA) with controlled environments", "Only networking", "Only storage"],
        correct: 1,
        explain: "Assured Workloads = create and maintain compliant environments (FedRAMP, HIPAA, etc.)."
      },
      { mode: "exam", topic: "Operations",
        q: "GCP folder in the resource hierarchy is used to:",
        options: ["Only billing", "Group projects and apply IAM/policy", "Only networking", "Only one project"],
        correct: 1,
        explain: "Folders = group projects; inherit IAM; organize by department or team."
      },
      { mode: "comparison", topic: "Infrastructure",
        q: "GCP Cloud Build is similar to which AWS service?",
        options: ["S3", "CodeBuild / CI/CD", "Redshift", "Lambda"],
        correct: 1,
        explain: "Cloud Build = CI/CD; build, test, deploy; like CodeBuild, CodePipeline."
      },
      { mode: "exam", topic: "AI",
        q: "Vertex AI Data Labeling is used for:",
        options: ["Only inference", "Creating labeled datasets for custom ML", "Only pre-trained APIs", "Only BigQuery ML"],
        correct: 1,
        explain: "Data Labeling = human labeling for custom models; images, text, video."
      },
      { mode: "exam", topic: "Infrastructure",
        q: "Which GCP product exposes and monetizes APIs with rate limiting and analytics?",
        options: ["Cloud Functions", "Apigee", "Cloud Armor", "Cloud Storage"],
        correct: 1,
        explain: "Apigee = API management; developer portal, rate limits, monetization; like API Gateway + more."
      },
      { mode: "exam", topic: "Data",
        q: "Dataform is used for:",
        options: ["Only storage", "SQL-based ELT in BigQuery (data modeling)", "Only Pub/Sub", "Only streaming"],
        correct: 1,
        explain: "Dataform = develop and schedule SQL workflows in BigQuery; dbt-like."
      },
      { mode: "exam", topic: "Digital Transformation",
        q: "Which benefit does elasticity provide?",
        options: ["Only fixed capacity", "Scale resources up or down based on demand", "Only manual scaling", "Only for storage"],
        correct: 1,
        explain: "Elasticity = automatically scale with demand; avoid over/under provisioning."
      },
      { mode: "exam", topic: "Security",
        q: "Cloud Identity is used for:",
        options: ["Only encryption", "Managing users, devices, and apps (free tier of Workspace identity)", "Only networking", "Only KMS"],
        correct: 1,
        explain: "Cloud Identity = identity and device management; free; can sync with AD."
      },
      { mode: "exam", topic: "Operations",
        q: "GCP Free Tier includes:",
        options: ["No free resources", "Always-free resources (e.g., Compute, Storage, BigQuery)", "Only 30 days", "Only for paid accounts"],
        correct: 1,
        explain: "Free tier = always-free resources; e.g., 1 f1-micro, 5 GB Cloud Storage, BigQuery 1 TB/month."
      },
      { mode: "exam", topic: "Data",
        q: "BigQuery ML allows you to:",
        options: ["Only run inference", "Create and run ML models using SQL in BigQuery", "Only use Vertex AI", "Only use AutoML"],
        correct: 1,
        explain: "BigQuery ML = create models (linear reg, logistic reg, etc.) with SQL; no export needed."
      },
      { mode: "exam", topic: "AI",
        q: "Vertex AI Prediction is used for:",
        options: ["Only training", "Serving trained models (online and batch prediction)", "Only data labeling", "Only notebooks"],
        correct: 1,
        explain: "Vertex AI Prediction = deploy models; online and batch prediction; autoscaling."
      },
      { mode: "exam", topic: "Infrastructure",
        q: "Which GCP region concept provides fault isolation within a region?",
        options: ["Only region", "Zone (availability zone)", "Only global", "Only folder"],
        correct: 1,
        explain: "Zone = isolation within region; deploy across zones for HA."
      },
      { mode: "exam", topic: "Digital Transformation",
        q: "Hybrid cloud typically includes:",
        options: ["Only public cloud", "On-premises and public cloud (often with connectivity)", "Only private cloud", "Only multicloud"],
        correct: 1,
        explain: "Hybrid = on-prem + public cloud; often with VPN or dedicated link."
      },
      { mode: "exam", topic: "Data",
        q: "Cloud Storage object versioning:",
        options: ["Is not supported", "Keeps a history of object versions (enable on bucket)", "Only for lifecycle", "Only for Nearline"],
        correct: 1,
        explain: "Object versioning = retain older versions; protect from overwrite/delete."
      },
      { mode: "exam", topic: "Security",
        q: "Titan Security Key is:",
        options: ["Only software", "Hardware security key for phishing-resistant 2SV", "Only for encryption", "Only for KMS"],
        correct: 1,
        explain: "Titan Key = hardware 2SV; phishing-resistant; FIDO2."
      },
      { mode: "exam", topic: "Operations",
        q: "GCP project is the base unit for:",
        options: ["Only networking", "Resources, billing, IAM, and APIs", "Only one resource", "Only folders"],
        correct: 1,
        explain: "Project = container for resources; has billing, IAM, APIs; like AWS account for a workload."
      },
      { mode: "exam", topic: "AI",
        q: "Contact Center AI (CCAI) provides:",
        options: ["Only translation", "Virtual agents, speech recognition, and analytics for contact centers", "Only Vision", "Only BigQuery"],
        correct: 1,
        explain: "CCAI = virtual agents, speech-to-text, sentiment; improve contact center operations."
      },
      { mode: "exam", topic: "Infrastructure",
        q: "Which GCP service is a managed Redis/Memcached?",
        options: ["Cloud SQL", "Memorystore", "Bigtable", "Firestore"],
        correct: 1,
        explain: "Memorystore = managed Redis or Memcached; in-memory cache/store."
      },
      { mode: "exam", topic: "Data",
        q: "Dataprep is used for:",
        options: ["Only storage", "Visual data preparation and cleansing (Trifacta)", "Only BigQuery", "Only Pub/Sub"],
        correct: 1,
        explain: "Dataprep = visual ETL; clean and prepare data; Trifacta; output to BigQuery, etc."
      },
      { mode: "exam", topic: "Digital Transformation",
        q: "Which cloud model requires the customer to manage the most?",
        options: ["SaaS", "PaaS", "IaaS", "FaaS"],
        correct: 2,
        explain: "IaaS = you manage OS, apps, data; most responsibility. SaaS = least."
      },
      { mode: "exam", topic: "Security",
        q: "Cloud Armor can:",
        options: ["Only load balance", "Provide DDoS protection and WAF rules (e.g., OWASP)", "Only encrypt", "Only IAM"],
        correct: 1,
        explain: "Cloud Armor = DDoS + WAF; attach to Load Balancer; OWASP, custom rules."
      },
      { mode: "exam", topic: "Operations",
        q: "SLI (Service Level Indicator) is:",
        options: ["Only a target", "A metric that indicates service level (e.g., availability)", "Only for cost", "Only for security"],
        correct: 1,
        explain: "SLI = measurable indicator (e.g., % successful requests). SLO = target for SLI."
      },
      { mode: "exam", topic: "Data",
        q: "BigQuery BI Engine provides:",
        options: ["Only storage", "In-memory acceleration for BI tools (sub-second queries)", "Only ETL", "Only Pub/Sub"],
        correct: 1,
        explain: "BI Engine = in-memory acceleration; fast dashboards on BigQuery."
      },
      { mode: "exam", topic: "AI",
        q: "Recommendations AI is used for:",
        options: ["Only translation", "Product recommendations (e.g., retail)", "Only Vision", "Only speech"],
        correct: 1,
        explain: "Recommendations AI = personalized product recommendations; retail, media."
      },
      { mode: "exam", topic: "Infrastructure",
        q: "Cloud Tasks is used for:",
        options: ["Only storage", "Asynchronous task execution (push or pull queues)", "Only BigQuery", "Only Pub/Sub"],
        correct: 1,
        explain: "Cloud Tasks = task queues; dispatch async work; HTTP or App Engine tasks."
      },
      { mode: "exam", topic: "Digital Transformation",
        q: "Which Google Cloud theme emphasizes collaboration and productivity?",
        options: ["Only cost", "Collaboration (Workspace, shared docs)", "Only AI", "Only networking"],
        correct: 1,
        explain: "Collaboration = Workspace integration, shared docs, real-time; productivity."
      },
      { mode: "exam", topic: "Data",
        q: "Spanner is suitable for:",
        options: ["Only single-region", "Globally distributed, strongly consistent relational workloads", "Only NoSQL", "Only analytics"],
        correct: 1,
        explain: "Spanner = global, strongly consistent, relational; horizontal scale; unique offering."
      },
      { mode: "exam", topic: "Security",
        q: "Chronicle SIEM ingests data from:",
        options: ["Only GCP", "Many sources (GCP, on-prem, third party) for security analysis", "Only BigQuery", "Only Pub/Sub"],
        correct: 1,
        explain: "Chronicle = ingest logs from many sources; security analytics; SIEM."
      },
      { mode: "exam", topic: "Operations",
        q: "GCP support plans include:",
        options: ["Only free", "Free, Standard, Enhanced, Premium (different SLAs and features)", "Only Premium", "Only Standard"],
        correct: 1,
        explain: "Support = Free (community), Standard, Enhanced, Premium; different response times and features."
      },
    ];

    const QUESTIONS_PER_QUIZ = 40;
    let currentIndex = 0;
    let score = 0;
    let answered = [];
    let sessionQuestions = [];
    let selectedMode = 'mixed';

    function getProfile() {
      try {
        const raw = localStorage.getItem(PROFILE_KEY);
        if (!raw) return { quizId: QUIZ_ID, topicStats: {}, topicMissesFromImports: {} };
        const p = JSON.parse(raw);
        return {
          quizId: p.quizId || QUIZ_ID,
          topicStats: p.topicStats || {},
          topicMissesFromImports: p.topicMissesFromImports || {}
        };
      } catch (e) {
        return { quizId: QUIZ_ID, topicStats: {}, topicMissesFromImports: {} };
      }
    }

    function saveProfile(profile) {
      try {
        localStorage.setItem(PROFILE_KEY, JSON.stringify(profile));
      } catch (e) {}
    }

    function getTopicWeight(profile, topic) {
      const t = topic || 'Other';
      let missRate = 0;
      if (profile.topicStats[t] && profile.topicStats[t].total > 0) {
        missRate = 1 - (profile.topicStats[t].correct / profile.topicStats[t].total);
      }
      const importMisses = (profile.topicMissesFromImports[t] || 0) * 0.2;
      return 1 + Math.min(missRate + importMisses, 2);
    }

    function shuffle(arr) {
      const a = [...arr];
      for (let i = a.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [a[i], a[j]] = [a[j], a[i]];
      }
      return a;
    }

    function weightedSample(arr, n, profile) {
      const hasData = profile && (Object.keys(profile.topicStats).length > 0 || Object.keys(profile.topicMissesFromImports).length > 0);
      if (!hasData) {
        const shuffled = shuffle(arr);
        return shuffled.slice(0, Math.min(n, shuffled.length));
      }
      const withKeys = arr.map(q => {
        const w = getTopicWeight(profile, q.topic);
        return { q, key: Math.pow(Math.random(), 1 / w) };
      });
      withKeys.sort((a, b) => b.key - a.key);
      return withKeys.slice(0, Math.min(n, withKeys.length)).map(x => x.q);
    }

    function getWeakTopics(profile, topN) {
      const scores = [];
      const topics = new Set([
        ...Object.keys(profile.topicStats || {}),
        ...Object.keys(profile.topicMissesFromImports || {})
      ]);
      topics.forEach(t => {
        let weakness = 0;
        if (profile.topicStats[t] && profile.topicStats[t].total > 0) {
          weakness = 1 - (profile.topicStats[t].correct / profile.topicStats[t].total);
        }
        weakness += (profile.topicMissesFromImports[t] || 0) * 0.15;
        scores.push({ topic: t, weakness });
      });
      scores.sort((a, b) => b.weakness - a.weakness);
      return scores.slice(0, topN).filter(x => x.weakness > 0.1).map(x => x.topic);
    }

    function selectMode(mode) {
      selectedMode = mode;
      document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('selected'));
      document.querySelector('[data-mode="' + mode + '"]').classList.add('selected');
    }

    function startQuiz() {
      const filtered = questionBank.filter(q => {
        if (selectedMode === 'comparison') return q.mode === 'comparison';
        if (selectedMode === 'exam') return q.mode === 'exam';
        return true;
      });
      const profile = getProfile();
      sessionQuestions = weightedSample(filtered, QUESTIONS_PER_QUIZ, profile);
      currentIndex = 0;
      score = 0;
      answered = [];
      const hintEl = document.getElementById('focus-hint');
      const weak = getWeakTopics(profile, 3);
      if (weak.length > 0) {
        hintEl.textContent = "We'll focus more on: " + weak.join(', ') + '.';
        hintEl.classList.remove('hidden');
      } else {
        hintEl.classList.add('hidden');
      }
      document.getElementById('start-screen').classList.add('hidden');
      document.getElementById('results-screen').classList.add('hidden');
      document.getElementById('quiz-area').classList.remove('hidden');
      document.getElementById('q-total').textContent = sessionQuestions.length;
      renderQuestion();
    }

    function renderQuestion() {
      const q = sessionQuestions[currentIndex];
      document.getElementById('q-num').textContent = currentIndex + 1;
      document.getElementById('score-display').textContent = score;
      document.getElementById('question-text').textContent = q.q;
      const opts = document.getElementById('options');
      opts.innerHTML = '';
      const fb = document.getElementById('feedback');
      fb.classList.add('hidden');
      fb.className = 'feedback hidden';

      q.options.forEach((opt, i) => {
        const div = document.createElement('div');
        div.className = 'option';
        div.textContent = opt;
        div.dataset.index = i;
        if (answered[currentIndex] !== undefined) {
          div.classList.add('disabled');
          if (i === q.correct) div.classList.add('correct');
          else if (i === answered[currentIndex]) div.classList.add('wrong');
        } else {
          div.onclick = () => selectOption(currentIndex, i, q);
        }
        opts.appendChild(div);
      });

      if (answered[currentIndex] !== undefined) {
        fb.classList.remove('hidden');
        fb.className = 'feedback ' + (answered[currentIndex] === q.correct ? 'correct-msg' : 'wrong-msg');
        fb.innerHTML = (answered[currentIndex] === q.correct ? '✓ Correct. ' : '✗ Incorrect. ') + '<span class="explanation">' + q.explain + '</span>';
      }

      document.getElementById('prev-btn').disabled = currentIndex === 0;
    }

    function selectOption(pos, optIdx, q) {
      if (answered[pos] !== undefined) return;
      answered[pos] = optIdx;
      if (optIdx === q.correct) score++;

      document.querySelectorAll('#options .option').forEach(o => {
        o.classList.add('disabled');
        o.onclick = null;
        if (parseInt(o.dataset.index) === q.correct) o.classList.add('correct');
        else if (parseInt(o.dataset.index) === optIdx) o.classList.add('wrong');
      });

      const fb = document.getElementById('feedback');
      fb.classList.remove('hidden');
      fb.innerHTML = (optIdx === q.correct ? '✓ Correct. ' : '✗ Incorrect. ') + '<span class="explanation">' + q.explain + '</span>';
      fb.className = 'feedback ' + (optIdx === q.correct ? 'correct-msg' : 'wrong-msg');
      document.getElementById('score-display').textContent = score;
    }

    function nextQuestion() {
      if (currentIndex < sessionQuestions.length - 1) {
        currentIndex++;
        renderQuestion();
      } else {
        showResults();
      }
    }

    function prevQuestion() {
      if (currentIndex > 0) {
        currentIndex--;
        renderQuestion();
      }
    }

    function saveSessionToProfile() {
      const profile = getProfile();
      sessionQuestions.forEach((q, i) => {
        const t = q.topic || 'Other';
        if (!profile.topicStats[t]) profile.topicStats[t] = { correct: 0, total: 0 };
        profile.topicStats[t].total++;
        if (answered[i] !== undefined && answered[i] === q.correct) {
          profile.topicStats[t].correct++;
        }
      });
      saveProfile(profile);
    }

    function showResults() {
      saveSessionToProfile();
      document.getElementById('quiz-area').classList.add('hidden');
      const r = document.getElementById('results-screen');
      r.classList.remove('hidden');
      const total = sessionQuestions.length;
      const pct = Math.round((score / total) * 100);
      document.getElementById('final-score').textContent = score + ' / ' + total + ' (' + pct + '%)';
      document.getElementById('final-score').className = 'score ' + (pct >= 70 ? 'pass' : 'fail');
      document.getElementById('result-msg').textContent = pct >= 70
        ? 'Passing is ~70%. You\'re on track!'
        : 'Aim for 70%+ on the real exam. Review the pattern guide and try again.';
      document.getElementById('copy-toast').classList.add('hidden');
    }

    function getResultsMarkdown() {
      const total = sessionQuestions.length;
      const pct = Math.round((score / total) * 100);
      const missed = sessionQuestions.map((q, i) => ({ q, i })).filter(x => answered[x.i] !== undefined && answered[x.i] !== x.q.correct);
      const topicCounts = {};
      missed.forEach(x => {
        const t = x.q.topic || 'Other';
        topicCounts[t] = (topicCounts[t] || 0) + 1;
      });
      let md = '# GCP Cloud Digital Leader Quiz Results\n\n';
      md += '**Date:** ' + new Date().toISOString().slice(0, 10) + '\n';
      md += '**Mode:** ' + (selectedMode === 'comparison' ? 'Comparison (GCP↔AWS)' : selectedMode === 'exam' ? 'Exam' : 'Mixed') + '\n';
      md += '**Score:** ' + score + '/' + total + ' (' + pct + '%)\n';
      md += '**Pass (70%):** ' + (pct >= 70 ? 'Yes' : 'No') + '\n\n';
      md += '---\n\n';
      md += '## Instructions for AI Refactoring\n\n';
      md += 'Paste this entire block into a Cursor chat and say:\n';
      md += '> "Refactor the GCP Cloud Digital Leader quiz based on my mistakes. Add more questions on my weak topics and create a focused retake quiz."\n\n';
      if (Object.keys(topicCounts).length > 0) {
        md += '## Misses by Topic\n\n';
        Object.entries(topicCounts).sort((a, b) => b[1] - a[1]).forEach(([t, n]) => {
          md += '- **' + t + ':** ' + n + ' missed\n';
        });
        md += '\n';
      }
      if (missed.length > 0) {
        md += '## Missed Questions (for AI refactoring)\n\n';
        missed.forEach((x, i) => {
          const q = x.q;
          const yourAns = q.options[answered[x.i]];
          const correctAns = q.options[q.correct];
          md += '### ' + (i + 1) + '. [' + (q.topic || 'General') + ']\n';
          md += '**Q:** ' + q.q + '\n';
          md += '**Your answer:** ' + yourAns + '\n';
          md += '**Correct answer:** ' + correctAns + '\n';
          md += '**Explanation:** ' + q.explain + '\n\n';
        });
      }
      return md;
    }

    function downloadResults() {
      const blob = new Blob([getResultsMarkdown()], { type: 'text/markdown' });
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = 'gcp_cloud_digital_leader_quiz_results_' + new Date().toISOString().slice(0, 10) + '.md';
      a.click();
      URL.revokeObjectURL(a.href);
    }

    function copyResultsToClipboard() {
      navigator.clipboard.writeText(getResultsMarkdown()).then(() => {
        document.getElementById('copy-toast').classList.remove('hidden');
        setTimeout(() => document.getElementById('copy-toast').classList.add('hidden'), 2500);
      });
    }

    function parseImportedResults(mdText) {
      const lines = mdText.split('\n');
      const firstLine = (lines[0] || '').toLowerCase();
      if (QUIZ_ID !== 'oci' && firstLine.includes('oci foundations')) return { ok: false, error: 'This file is for OCI quiz. Open the OCI quiz to import it.' };
      if (QUIZ_ID !== 'gcp' && firstLine.includes('gcp cloud digital leader')) return { ok: false, error: 'This file is for GCP quiz. Open the GCP quiz to import it.' };
      if (QUIZ_ID !== 'az900' && (firstLine.includes('az-900') || firstLine.includes('azure'))) return { ok: false, error: 'This file is for AZ-900 quiz. Open the AZ-900 quiz to import it.' };
      if (QUIZ_ID === 'gcp' && !firstLine.includes('gcp')) return { ok: false, error: 'Not a GCP results file.' };
      let inSection = false;
      const topicMisses = {};
      for (let i = 0; i < lines.length; i++) {
        const line = lines[i];
        if (line.indexOf('## Misses by Topic') !== -1) {
          inSection = true;
          continue;
        }
        if (inSection && line.startsWith('## ')) break;
        if (inSection && line.match(/^\s*-\s*\*\*(.+?)\*\*:\s*(\d+)\s+missed/)) {
          const m = line.match(/^\s*-\s*\*\*(.+?)\*\*:\s*(\d+)\s+missed/);
          const topic = m[1].trim();
          const n = parseInt(m[2], 10);
          topicMisses[topic] = (topicMisses[topic] || 0) + n;
        }
      }
      if (Object.keys(topicMisses).length === 0) return { ok: false, error: 'No "Misses by Topic" section found.' };
      return { ok: true, topicMisses };
    }

    function importResults() {
      const ta = document.getElementById('import-results');
      const mdText = (ta && ta.value || '').trim();
      if (!mdText) {
        showImportToast('Paste results markdown first, or choose a file.', true);
        return;
      }
      const result = parseImportedResults(mdText);
      if (!result.ok) {
        showImportToast(result.error || 'Could not parse results.', true);
        return;
      }
      const profile = getProfile();
      if (!profile.topicMissesFromImports) profile.topicMissesFromImports = {};
      Object.entries(result.topicMisses).forEach(([topic, n]) => {
        profile.topicMissesFromImports[topic] = (profile.topicMissesFromImports[topic] || 0) + n;
      });
      saveProfile(profile);
      const top = Object.entries(result.topicMisses).sort((a, b) => b[1] - a[1]).slice(0, 3).map(x => x[0]);
      showImportToast('Imported. We\'ll focus more on: ' + top.join(', ') + '.', false);
      if (ta) ta.value = '';
    }

    function onImportFile(ev) {
      const f = ev.target.files && ev.target.files[0];
      if (!f) return;
      const r = new FileReader();
      r.onload = function () {
        const ta = document.getElementById('import-results');
        if (ta) ta.value = r.result || '';
        importResults();
      };
      r.readAsText(f);
      ev.target.value = '';
    }

    function showImportToast(msg, isError) {
      const el = document.getElementById('import-toast');
      if (!el) return;
      el.textContent = msg;
      el.className = 'import-toast ' + (isError ? 'err' : 'success');
      el.classList.remove('hidden');
      setTimeout(() => el.classList.add('hidden'), 4000);
    }

    (function initFocusHint() {
      const profile = getProfile();
      const weak = getWeakTopics(profile, 3);
      const hintEl = document.getElementById('focus-hint');
      if (hintEl && weak.length > 0) {
        hintEl.textContent = "We'll focus more on: " + weak.join(', ') + '.';
        hintEl.classList.remove('hidden');
      }
    })();
  </script>
</body>
</html>
